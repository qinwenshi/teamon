/*
  filename: jquery.integralui.slidebar.min.js
  version : 1.0.038
  Copyright © 2014 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
(function(d){d.widget("integralui.slidebar",d.integralui.widget,{version:"1.0.038",options:{animationSpeed:2E3,selectedIndex:-1,selectedSlide:null,showButtons:!0,slideWidth:0,slideHeight:0},_create:function(){this._super();this.widgetName="slidebar";this.eventNames={beforeAdd:"slideadding",beforeRemove:"slideremoving",afterAdd:"slideadded",afterRemove:"slideremoved"};this.animationInterrupted=this.animationActive=!1;this.currentAnimationIndex=1;this.timeout=null;this.classNames={slide:"iui-slidebar-box",navBar:"iui-slidebar-nav-bar",button:{normal:"iui-slidebar-button",selected:"iui-slidebar-button-selected"}};this.element.addClass("iui-slidebar");this._initFromHTML();this.element.append(this.$tw);this._s1t(this.twp)},_bindEvents:function(){var a=this;a.element.off(a.eventList).on({slideremoving:function(b){a._slideRemoving(b)},slideremoved:function(b){a._slideRemoved(b)}})},_destroy:function(){this.stopAnimation();var a=this.$slideBar.children("li");0<a.length&&a.removeUniqueId();this.element.empty();this._super()},_initFromHTML:function(){var a=this;a.$slideBar=this.element.find("ul:first-of-type").addClass(a.classNames.slide);return 0<a.$slideBar.length?(a.allowUpdate=!1,a.$slideBar.children("li").each(function(b,c){a.addSlide(a._extractSlide(b,c))}),a.allowUpdate=!0,a.refresh(),!0):!1},_extractSlide:function(a,b){var c=d(b);c.attr("id")||c.uniqueId();return{id:c.attr("id"),content:c.html()}},_setOption:function(a,b){switch(a){case "allowAnimation":if(!0!==b&&!1!==b)return;this.options.allowAnimation=b;this.options.allowAnimation||this.stopAnimation();break;case "selectedIndex":if(this._isIndexInRange(b))if(this._selectSlide(this.currentList[b]))this._updateCurrentSelection();else return;else return;break;case "selectedSlide":if(this._selectSlide(b))this._updateCurrentSelection();else return;break;case "showButtons":if(!0!==b&&!1!==b)return;this.options.showButtons=b;this.options.showButtons?this.$navBar.show():this.$navBar.hide();break;case "slideWidth":this.options.slideWidth=b;break;case "slideHeight":this.options.slideHeight=b}"allowAnimation"!==a&&this._super(a,b)},_selectSlide:function(a){var b={slide:a,index:d.inArray(a,this.currentList)};return!1!==this._triggerEvent("slidechanging",b)&&this.options.selectedSlide!==a?(this.options.selectedSlide=a,this.options.selectedIndex=this.options.selectedSlide?d.inArray(this.options.selectedSlide,this.currentList):-1,this._triggerEvent("slidechanged",b),!0):!1},_buttonClick:function(a,b){a.preventDefault();if(this._isIndexInRange(b)&&1===a.which){var c={slide:this.currentList[b],index:b};!1!==this._triggerEvent("buttonclicking",c)&&(this.stopAnimation(),this.option("selectedSlide",this.currentList[b]),this.animationInterrupted=!1,this._triggerEvent("buttonclicked",c))}a.stopPropagation()},_slideMouseEnter:function(a,b){a.preventDefault();this._isIndexInRange(b)&&this._triggerEvent("slidehover",{slide:this.currentList[b],index:b});a.stopPropagation()},_rebindEvents:function(){var a=this;a.$navBar.children("li").each(function(b){d(this).off("click").on({click:function(c){a._buttonClick(c,b)}})});a.$slideBar.children("li").each(function(b){d(this).off("mouseenter").on({mouseenter:function(c){a._slideMouseEnter(c,b)}})})},_slideRemoving:function(a){this.removeIndex=this.options.selectedIndex},_slideRemoved:function(a){0<this.currentList.length?(a=Math.max(Math.min(this.removeIndex,this.currentList.length-1),0),this.option("selectedIndex",a)):(this.options.selectedSlide=null,this.options.selectedIndex=-1)},addSlide:function(a){this._add(a)},clearSlides:function(){this._clear()},insertSlideAfter:function(a,b){this._insertAfter(a,b)},insertSlideAt:function(a,b){this._insertAt(a,b)},insertSlideBefore:function(a,b){this._insertBefore(a,b)},removeSlide:function(a){this._remove(a)},removeSlideAt:function(a){this._removeAt(a)},_animate:function(){this.animationInterrupted?this.animationActive=!1:(this.animationActive=!0,this.currentAnimationIndex>this.currentList.length-1?(this.currentAnimationIndex=0,this.option("selectedIndex",this.currentAnimationIndex),this.$slideBar.css("margin-left",0),this._animate()):(this.currentAnimationIndex+=1,this.option("selectedIndex",this.currentAnimationIndex-1),this._updateSlide()))},_isAnimationActive:function(){return self.animationActive},startAnimation:function(){var a=this;a.animationInterrupted=!1;a.currentAnimationIndex=this.options.selectedIndex+1;a.timeout=setTimeout(function(){a.animationActive=!0;a.$slideBar.animate({marginLeft:a.options.slideWidth*a.currentAnimationIndex*-1-1,queue:!1},800,function(){a._animate()})},a.options.animationSpeed)},stopAnimation:function(){this._clearAnimation();this.animationInterrupted=!0,this.currentAnimationIndex--,0>this.currentAnimationIndex&&(this.currentAnimationIndex=0),this.$slideBar.css("margin-left",this.options.slideWidth*this.currentAnimationIndex*-1-1)},_clearAnimation:function(){this.timeout&&(clearTimeout(this.timeout),this.animationActive=!1,this.$slideBar.stop())},findSlideById:function(a,b){return this._findItemById(a,b)},getSlideElement:function(a){return a?this.$slideBar.find("li[id='"+a.id+"']"):null},_createElement:function(a){a.id||(a.id=this._createId());var b="<li id="+a.id+">",b=b+a.content;return b+"</li>"},refresh:function(){this._super();var a=this;if(a._isUpdateAllowed()){a.element.empty();var b=a.getList();a.$slideBar=d("<ul class='"+a.classNames.slide+"'></ul>");a.$navBar=d("<ul class='"+a.classNames.navBar+"'></ul>");var c="";b.forEach(function(b,d){c=a._createElement(b);a.$slideBar.append(c);a.options.showButtons&&a.$navBar.append("<li class='"+a.classNames.button.normal+"'></li>")});a.element.append(a.$tw);a._updateSelectedIndex();a._updateCurrentSelection();a._rebindEvents();b=a.$slideBar.children().first().clone();b.attr("id","");a.$slideBar.append(b);a.element.append(a.$slideBar);a.element.append("<br style='clear:both;'/>");a.options.showButtons&&a.element.append(a.$navBar);a.$slideBar.css("width",a.options.slideWidth*a.$slideBar.children("li").length+"px");a.$slideBar.parent().css("width",a.options.slideWidth+"px");a._updateSlide()}},_updateCurrentSelection:function(){var a=this;a._isIndexInRange(a.options.selectedIndex)&&(a._isAnimationActive()||a.$slideBar.css({"margin-left":function(){return a.options.slideWidth*a.options.selectedIndex*-1-1}}),a.options.showButtons&&a.$navBar.children("li").removeClass(a.classNames.button.selected).filter("li:eq("+a.options.selectedIndex+")").addClass(a.classNames.button.selected))},_updateSelectedIndex:function(){if(0<this.currentList.length){0>this.options.selectedIndex&&this.options.selectedSlide&&(this.options.selectedIndex=d.inArray(this.options.selectedSlide,this.currentList));this.options.selectedSlide||(this._isIndexInRange(this.options.selectedIndex)?this.options.selectedSlide=this.currentList[this.options.selectedIndex]:this.options.selectedSlide=this.currentList[0]);var a=d.inArray(this.options.selectedSlide,this.currentList);this.options.selectedIndex!==a&&(this.options.selectedIndex=a)}else this.options.selectedSlide=null,this.options.selectedIndex=-1},_updateSlide:function(){this._clearAnimation();0<this.currentList.length&&this.options.allowAnimation&&!this.animationInterrupted&&this.startAnimation()}})})(jQuery);